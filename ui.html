<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clipboard Plugin</title>
  <style>
    body {
      background-color: #1E1E1E; /* Dark mode background */
      color: #FFFFFF; /* Light text */
      font-family: Arial, sans-serif;
      font-size: 14px;
      padding: 16px;
      text-align: center;
    }

    p {
      font-size: 12px;
      margin-bottom: 8px;
      text-align: left;
      color: #cacaca;
      padding: 0px 8px 8px 0px;  
    }

    #clipboard-container {
      background-color: #2D2D2D;
      border-radius: 8px;
      padding: 10px;
      max-height: 60vh; /* Scrollable */
      overflow-y: auto;
      text-align: left;
      font-size: 14px;
    }

    .clipboard-item {
      padding: 6px;
      border-bottom: 1px solid #444;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
      cursor: pointer; /* Clickable */
    }

    .clipboard-item:hover {
      white-space: normal;
      background-color: #3A3A3A;
      padding: 6px;
      border-radius: 4px;
      position: relative;
      z-index: 10;
    }

    button {
      background-color: #6C757D; /* Grey button */
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      font-size: 14px;
      width: 100%;
    }

    button:hover {
      background-color: #5A6268;
    }
  </style>
</head>
<body>
  <p>Select text elements in Figma to copy them to the clipboard. Click an item in the clipboard to paste it back.</p>
  <div id="clipboard-container"></div>
  <button id="clearClipboard">Clear Clipboard</button>

  <script>
    window.onmessage = (event) => {
      const message = event.data.pluginMessage;
      if (message.type === 'update-clipboard') {
        const container = document.getElementById('clipboard-container');
        container.innerHTML = message.items.map(item => 
          `<div class="clipboard-item" data-text="${item}" title="${item}">${item.length > 100 ? item.substring(0, 100) + '...' : item}</div>`).join('');
      }
    };

    // Handle click event to paste text back into Figma
    document.getElementById('clipboard-container').addEventListener('click', (event) => {
      if (event.target.classList.contains('clipboard-item')) {
        const textToPaste = event.target.getAttribute('data-text');
        parent.postMessage({ pluginMessage: { type: 'paste-text', text: textToPaste } }, '*');
      }
    });

    document.getElementById('clearClipboard').addEventListener('click', () => {
      parent.postMessage({ pluginMessage: { type: 'clear-clipboard' } }, '*');
    });
  </script>
</body>
</html>
