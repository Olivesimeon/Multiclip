<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clipboard Plugin</title>
  <style>
    body {
      background-color: #1E1E1E; /* Dark mode background */
      color: #FFFFFF; /* Light text */
      font-family: Inter, sans-serif;
      font-weight: 300;
      font-size: 14px;
      padding: 8px;
      text-align: center;
    }

    p {
      font-size: 12px;
      margin-bottom: 8px;
      text-align: left;
      color: #cacaca;
      padding: 0px 8px 8px 0px;  
    }

    #clipboard-container {
      background-color: #2D2D2D;
      border-radius: 12px;
      border: 1px solid #424242;
      padding: 16px;
      max-height: 72vh;
      min-height: 72vh; /* Ensure a fixed height */
      overflow-y: auto;
      text-align: left;
      font-size: 14px;
      display: flexbox;
      flex-direction: column;
      justify-content: top; /* Center content when empty */
      align-items: top;
    }

    .clipboard-item {
      padding: 8px;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
      cursor: pointer;
      text-align: left;
    }

    .clipboard-item:hover {
      white-space: normal;
      background-color: #3A3A3A;
      padding: 6px;
      border: 1px solid #3e3e3e;
      border-radius: 8px;
      position: relative;
      z-index: 10;
    }

    .empty-placeholder {
      color: #888;
      font-size: 14px;
      font-style: normal;
      text-align: left;
    }

    button {
      background-color: #2F80ED;
      color: white;
      border: none;
      padding: 16px 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 16px;
      font-size: 14px;
      width: 100%;
    }

    button:hover {
      background-color: #054ead;
    }
  </style>
</head>
<body></body>
  <div id="clipboard-container">
    <span id="emptyMessage" class="empty-placeholder">Select text elements in Figma to copy them to the clipboard. Click an item to paste.</span>
  </div>
  <button id="clearClipboard">Clear all</button>

  <script>
    function pasteToFigma(content) {
      parent.postMessage({ pluginMessage: { type: 'paste-text', content } }, '*');
    }
    function addToClipboard(content) {
      parent.postMessage({ pluginMessage: { type: 'add-to-clipboard', content } }, '*');
    }

    window.onmessage = (event) => {
      const message = event.data.pluginMessage;
      const container = document.getElementById('clipboard-container');
      const emptyMessage = document.getElementById('emptyMessage');
      console.log(message)
      if (message.type === 'update-clipboard') {
        container.innerHTML = message.items.length > 0
          ? message.items.map(item => 
              `<div class="clipboard-item" data-text="${item}" title="${item}">
                ${item.length > 100 ? item.substring(0, 100) + '...' : item}
              </div>`
            ).join('')
          : '<span id="emptyMessage" class="empty-placeholder">Select text elements in Figma to copy them to the clipboard. Click to paste.</span>';
      }
    };
    
//     document.addEventListener("keydown", (e) => {
//   const ctrlDown = e.metaKey || e.ctrlKey;
//   if (ctrlDown) {
//     if (e.key === "x") {
//       addToClipboard();
//     } else if (e.key === "c") {
//       addToClipboard();
//     }
//   }
// });

    document.getElementById('clipboard-container').addEventListener('click', (event) => {
      if (event.target.classList.contains('clipboard-item')) {
        const textToPaste = event.target.getAttribute('data-text');
        pasteToFigma(textToPaste);
      }
    });

    document.getElementById('clearClipboard').addEventListener('click', () => {
      parent.postMessage({ pluginMessage: { type: 'clear-clipboard' } }, '*');
    });
  </script>
</body>
</html>
